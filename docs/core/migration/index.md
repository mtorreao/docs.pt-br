---
title: Migração do .NET Core com project.json
description: Saiba como migrar um projeto .NET Core mais antigo usando project.json
ms.date: 07/19/2017
ms.openlocfilehash: 73fbfed6943e3eb535e6eead3b3496edd3426c26
ms.sourcegitcommit: 7ef96827b161ef3fcde75f79d839885632e26ef1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/07/2021
ms.locfileid: "97970714"
---
# <a name="migrating-net-core-projects-from-projectjson"></a><span data-ttu-id="ab3a2-103">Migração de projetos do .NET Core com project.json</span><span class="sxs-lookup"><span data-stu-id="ab3a2-103">Migrating .NET Core projects from project.json</span></span>

<span data-ttu-id="ab3a2-104">Este documento aborda os três cenários de migração a seguir para projetos do .NET Core:</span><span class="sxs-lookup"><span data-stu-id="ab3a2-104">This document covers the following three migration scenarios for .NET Core projects:</span></span>

1. [<span data-ttu-id="ab3a2-105">Migração de um esquema válido mais recente do *project.json* para o *csproj*</span><span class="sxs-lookup"><span data-stu-id="ab3a2-105">Migration from a valid latest schema of *project.json* to *csproj*</span></span>](#migration-from-projectjson-to-csproj)
2. [<span data-ttu-id="ab3a2-106">Migração do DNX para o csproj</span><span class="sxs-lookup"><span data-stu-id="ab3a2-106">Migration from DNX to csproj</span></span>](#migration-from-dnx-to-csproj)
3. [<span data-ttu-id="ab3a2-107">Migração do RC3 e de projetos csproj anteriores do .NET Core para o formato final</span><span class="sxs-lookup"><span data-stu-id="ab3a2-107">Migration from RC3 and previous .NET Core csproj projects to the final format</span></span>](#migration-from-earlier-net-core-csproj-formats-to-rtm-csproj)

<span data-ttu-id="ab3a2-108">Este documento só é aplicável a projetos do .NET Core mais antigos que usam project.jsno.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-108">This document is only applicable to older .NET Core projects that use project.json.</span></span> <span data-ttu-id="ab3a2-109">Ele não se aplica à migração do .NET Framework para o .NET Core.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-109">It does not apply to migrating from .NET Framework to .NET Core.</span></span>

## <a name="migration-from-projectjson-to-csproj"></a><span data-ttu-id="ab3a2-110">Migração do project.json para o csproj</span><span class="sxs-lookup"><span data-stu-id="ab3a2-110">Migration from project.json to csproj</span></span>

<span data-ttu-id="ab3a2-111">A migração do *project.json* para o *.csproj* pode ser feita usando um dos seguintes métodos:</span><span class="sxs-lookup"><span data-stu-id="ab3a2-111">Migration from *project.json* to *.csproj* can be done using one of the following methods:</span></span>

- [<span data-ttu-id="ab3a2-112">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ab3a2-112">Visual Studio</span></span>](#visual-studio)
- [<span data-ttu-id="ab3a2-113">ferramenta de linha de comando de migração do dotnet</span><span class="sxs-lookup"><span data-stu-id="ab3a2-113">dotnet migrate command-line tool</span></span>](#dotnet-migrate)

<span data-ttu-id="ab3a2-114">Ambos os métodos usam o mesmo mecanismo subjacente para migrar os projetos. Portanto, os resultados serão os mesmos.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-114">Both methods use the same underlying engine to migrate the projects, so the results will be the same for both.</span></span> <span data-ttu-id="ab3a2-115">Na maioria dos casos, usar uma dessas duas maneiras de migrar o *project.js* de para *csproj* é a única coisa necessária e nenhuma outra edição manual do arquivo de projeto é necessária.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-115">In most cases, using one of these two ways to migrate the *project.json* to *csproj* is the only thing that is needed, and no further manual editing of the project file is necessary.</span></span> <span data-ttu-id="ab3a2-116">O arquivo *.csproj* resultante terá o mesmo nome que o diretório contido.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-116">The resulting *.csproj* file will be named the same as the containing directory name.</span></span>

### <a name="visual-studio"></a><span data-ttu-id="ab3a2-117">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ab3a2-117">Visual Studio</span></span>

<span data-ttu-id="ab3a2-118">Quando você abre um arquivo *. xproj* ou um arquivo de solução que referencia arquivos *. Xproj* no Visual Studio 2017 ou no visual Studio 2019 versão 16,2 e anterior, a caixa de diálogo **atualização unidirecional** é exibida.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-118">When you open an *.xproj* file or a solution file that references *.xproj* files in Visual Studio 2017 or Visual Studio 2019 version 16.2 and earlier, the **One-way upgrade** dialog appears.</span></span> <span data-ttu-id="ab3a2-119">A caixa de diálogo exibe os projetos a serem migrados.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-119">The dialog displays the projects to be migrated.</span></span> <span data-ttu-id="ab3a2-120">Se você abrir um arquivo de solução, todos os projetos especificados no arquivo de solução serão listados.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-120">If you open a solution file, all the projects specified in the solution file are listed.</span></span> <span data-ttu-id="ab3a2-121">Examine a lista de projetos a serem migrados e selecione **OK**.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-121">Review the list of projects to be migrated and select **OK**.</span></span>

![Caixa de diálogo Atualização unidirecional mostrando a lista de projetos que serão migrados](media/one-way-upgrade.jpg)

<span data-ttu-id="ab3a2-123">O Visual Studio migra os projetos selecionados automaticamente.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-123">Visual Studio migrates the selected projects automatically.</span></span> <span data-ttu-id="ab3a2-124">Ao migrar uma solução, se você não escolher todos os projetos, a mesma caixa de diálogo será exibida solicitando que você atualize os projetos restantes dessa solução.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-124">When migrating a solution, if you don't choose all projects, the same dialog appears asking you to upgrade the remaining projects from that solution.</span></span> <span data-ttu-id="ab3a2-125">Depois que o projeto for migrado, você poderá ver e modificar seu conteúdo clicando com o botão direito do mouse no projeto na janela **Gerenciador de soluções** e selecionando **Edit \<project name> . csproj**.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-125">After the project is migrated, you can see and modify its contents by right-clicking the project in the **Solution Explorer** window and selecting **Edit \<project name>.csproj**.</span></span>

<span data-ttu-id="ab3a2-126">Os arquivos que foram migrados (*project.jsem*, *global.jsem*, *. xproj* e arquivo de solução) são movidos para uma pasta de *backup* .</span><span class="sxs-lookup"><span data-stu-id="ab3a2-126">Files that were migrated (*project.json*, *global.json*, *.xproj*, and solution file) are moved to a *Backup* folder.</span></span> <span data-ttu-id="ab3a2-127">O arquivo de solução migrado é atualizado para o Visual Studio 2017 ou o Visual Studio 2019 e você não poderá abrir esse arquivo de solução no Visual Studio 2015 ou em versões anteriores.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-127">The migrated solution file is upgraded to Visual Studio 2017 or Visual Studio 2019 and you won't be able to open that solution file in Visual Studio 2015 or earlier versions.</span></span> <span data-ttu-id="ab3a2-128">Um arquivo chamado *UpgradeLog.htm* que contém um relatório de migração também é salvo e aberto automaticamente.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-128">A file named *UpgradeLog.htm* that contains a migration report is also saved and opened automatically.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ab3a2-129">No Visual Studio 2019 versão 16,3 e posterior, você não pode carregar ou migrar um arquivo *. xproj* .</span><span class="sxs-lookup"><span data-stu-id="ab3a2-129">In Visual Studio 2019 version 16.3 and later, you cannot load or migrate an *.xproj* file.</span></span> <span data-ttu-id="ab3a2-130">Além disso, o Visual Studio 2015 não fornece a capacidade de migrar um arquivo *. xproj* .</span><span class="sxs-lookup"><span data-stu-id="ab3a2-130">Additionally, Visual Studio 2015 doesn't provide the ability to migrate an *.xproj* file.</span></span> <span data-ttu-id="ab3a2-131">Se você estiver usando uma dessas versões do Visual Studio, instale uma versão adequada do Visual Studio ou use a ferramenta de migração de linha de comando descrita a seguir.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-131">If you're using one of these Visual Studio versions, either install a suitable version of Visual Studio, or use the command line migration tool that's described next.</span></span>

### <a name="dotnet-migrate"></a><span data-ttu-id="ab3a2-132">dotnet migrate</span><span class="sxs-lookup"><span data-stu-id="ab3a2-132">dotnet migrate</span></span>

<span data-ttu-id="ab3a2-133">No cenário de linha de comando, você pode usar o [`dotnet migrate`](../tools/dotnet-migrate.md) comando.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-133">In the command-line scenario, you can use the [`dotnet migrate`](../tools/dotnet-migrate.md) command.</span></span> <span data-ttu-id="ab3a2-134">Ele migra um projeto, uma solução ou um conjunto de pastas nessa ordem, dependendo de quais foram encontrados.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-134">It migrates a project, a solution, or a set of folders in that order, depending on which ones were found.</span></span> <span data-ttu-id="ab3a2-135">Ao migrar um projeto, o projeto e todas as suas dependências são migrados.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-135">When you migrate a project, the project and all its dependencies are migrated.</span></span>

<span data-ttu-id="ab3a2-136">Os arquivos que foram migrados (*project.json*, *global.json* e *. xproj*) são movidos para uma pasta de *backup* .</span><span class="sxs-lookup"><span data-stu-id="ab3a2-136">Files that were migrated (*project.json*, *global.json*, and *.xproj*) are moved to a *backup* folder.</span></span>

> [!NOTE]
> <span data-ttu-id="ab3a2-137">Se você estiver usando Visual Studio Code, o `dotnet migrate` comando não modificará arquivos específicos de Visual Studio Code, como *tasks.jsem*.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-137">If you are using Visual Studio Code, the `dotnet migrate` command does not modify Visual Studio Code-specific files such as *tasks.json*.</span></span> <span data-ttu-id="ab3a2-138">Esses arquivos precisam ser alterados manualmente.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-138">These files need to be changed manually.</span></span>
> <span data-ttu-id="ab3a2-139">Isso também será verdadeiro se você estiver usando um editor ou IDE (ambiente de desenvolvimento integrado) diferente do Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-139">This is also true if you are using an editor or Integrated Development Environment (IDE) other than Visual Studio.</span></span>

<span data-ttu-id="ab3a2-140">Consulte [um mapeamento entre project.jsPropriedades on e csproj](../tools/project-json-to-csproj.md) para uma comparação de *project.jsnos* formatos e *. csproj* .</span><span class="sxs-lookup"><span data-stu-id="ab3a2-140">See [A mapping between project.json and csproj properties](../tools/project-json-to-csproj.md) for a comparison of *project.json* and *.csproj* formats.</span></span>

<span data-ttu-id="ab3a2-141">Se houver um erro:</span><span class="sxs-lookup"><span data-stu-id="ab3a2-141">If you get an error:</span></span>

> <span data-ttu-id="ab3a2-142">Nenhum executável encontrado correspondendo ao comando dotnet-migrar</span><span class="sxs-lookup"><span data-stu-id="ab3a2-142">No executable found matching command dotnet-migrate</span></span>

<span data-ttu-id="ab3a2-143">Execute `dotnet --version` para ver qual versão você está usando.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-143">Run `dotnet --version` to see which version you are using.</span></span> <span data-ttu-id="ab3a2-144">[`dotnet migrate`](../tools/dotnet-migrate.md) foi introduzido no SDK do .NET Core 1.0.0 e removido na versão 3.0.100.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-144">[`dotnet migrate`](../tools/dotnet-migrate.md) was introduced in .NET Core SDK 1.0.0 and removed in version 3.0.100.</span></span>
<span data-ttu-id="ab3a2-145">Você receberá esse erro se tiver um *global.jsno* arquivo no diretório atual ou pai, e a `sdk` versão que ele especifica estiver fora desse intervalo.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-145">You'll get this error if you have a *global.json* file in the current or parent directory, and the `sdk` version it specifies is outside this range.</span></span>

## <a name="migration-from-dnx-to-csproj"></a><span data-ttu-id="ab3a2-146">Migração do DNX para o csproj</span><span class="sxs-lookup"><span data-stu-id="ab3a2-146">Migration from DNX to csproj</span></span>

<span data-ttu-id="ab3a2-147">Se você ainda estiver usando o DNX para desenvolvimento no .NET Core, o processo de migração deverá ser feito em dois estágios:</span><span class="sxs-lookup"><span data-stu-id="ab3a2-147">If you are still using DNX for .NET Core development, your migration process should be done in two stages:</span></span>

1. <span data-ttu-id="ab3a2-148">Use as [diretrizes de migração existentes do DNX](from-dnx.md) para migrar do DNX para a CLI habilitada para project-json.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-148">Use the [existing DNX migration guidance](from-dnx.md) to migrate from DNX to project-json enabled CLI.</span></span>
2. <span data-ttu-id="ab3a2-149">Siga as etapas da seção anterior para migrar do *project.json* para o *.csproj*.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-149">Follow the steps from the previous section to migrate from *project.json* to *.csproj*.</span></span>

> [!NOTE]
> <span data-ttu-id="ab3a2-150">O DNX foi preterido oficialmente durante a versão Visualização 1 da CLI do .NET Core.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-150">DNX has become officially deprecated during the Preview 1 release of the .NET Core CLI.</span></span>

## <a name="migration-from-earlier-net-core-csproj-formats-to-rtm-csproj"></a><span data-ttu-id="ab3a2-151">Migração de formatos csproj anteriores do .NET Core para o csproj do RTM</span><span class="sxs-lookup"><span data-stu-id="ab3a2-151">Migration from earlier .NET Core csproj formats to RTM csproj</span></span>

<span data-ttu-id="ab3a2-152">O formato csproj do .NET Core foi mudando e evoluindo com cada nova versão de pré-lançamento da ferramenta.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-152">The .NET Core csproj format has been changing and evolving with each new pre-release version of the tooling.</span></span> <span data-ttu-id="ab3a2-153">Não há nenhuma ferramenta que migrará seu arquivo de projeto de versões anteriores do csproj para a versão mais recente. Sendo assim, você precisa editar manualmente o arquivo de projeto.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-153">There is no tool that will migrate your project file from earlier versions of csproj to the latest, so you need to manually edit the project file.</span></span> <span data-ttu-id="ab3a2-154">As etapas reais dependem da versão do arquivo de projeto que você está migrando.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-154">The actual steps depend on the version of the project file you are migrating.</span></span> <span data-ttu-id="ab3a2-155">A seguir, há algumas diretrizes para serem consideradas com base nas alterações que ocorreram entre as versões:</span><span class="sxs-lookup"><span data-stu-id="ab3a2-155">The following is some guidance to consider based on the changes that happened between versions:</span></span>

- <span data-ttu-id="ab3a2-156">Remova a propriedade de versão das ferramentas do elemento `<Project>`, se ele existir.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-156">Remove the tools version property from the `<Project>` element, if it exists.</span></span>
- <span data-ttu-id="ab3a2-157">Remova o namespace de XML (`xmlns`) do elemento `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-157">Remove the XML namespace (`xmlns`) from the `<Project>` element.</span></span>
- <span data-ttu-id="ab3a2-158">Se ele não existir, adicione o atributo `Sdk` ao elemento `<Project>` e defina-o como `Microsoft.NET.Sdk` ou `Microsoft.NET.Sdk.Web`.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-158">If it doesn't exist, add the `Sdk` attribute to the `<Project>` element and set it to `Microsoft.NET.Sdk` or `Microsoft.NET.Sdk.Web`.</span></span> <span data-ttu-id="ab3a2-159">Esse atributo especifica que o projeto usa o SDK que será utilizado.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-159">This attribute specifies that the project uses the SDK to be used.</span></span> <span data-ttu-id="ab3a2-160">`Microsoft.NET.Sdk.Web` é usado em aplicativos Web.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-160">`Microsoft.NET.Sdk.Web` is used for web apps.</span></span>
- <span data-ttu-id="ab3a2-161">Remova as instruções `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` e `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` da parte superior e inferior do projeto.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-161">Remove the `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` and `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` statements from the top and bottom of the project.</span></span> <span data-ttu-id="ab3a2-162">Essas instruções estão implícitas no SDK. Portanto, não é necessário que elas estejam no projeto.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-162">These import statements are implied by the SDK, so there is no need for them to be in the project.</span></span>
- <span data-ttu-id="ab3a2-163">Se você tiver `Microsoft.NETCore.App` ou `NETStandard.Library` `<PackageReference>` itens em seu projeto, deverá removê-los.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-163">If you have `Microsoft.NETCore.App` or `NETStandard.Library` `<PackageReference>` items in your project, you should remove them.</span></span> <span data-ttu-id="ab3a2-164">Essas referências do pacote estão [implícitas no SDK](../tools/csproj.md).</span><span class="sxs-lookup"><span data-stu-id="ab3a2-164">These package references are [implied by the SDK](../tools/csproj.md).</span></span>
- <span data-ttu-id="ab3a2-165">Remova o `Microsoft.NET.Sdk` `<PackageReference>` elemento, se ele existir.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-165">Remove the `Microsoft.NET.Sdk` `<PackageReference>` element, if it exists.</span></span> <span data-ttu-id="ab3a2-166">A referência do SDK é fornecida por meio do atributo `Sdk` no elemento `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-166">The SDK reference comes through the `Sdk` attribute on the `<Project>` element.</span></span>
- <span data-ttu-id="ab3a2-167">Remova os [globs](https://en.wikipedia.org/wiki/Glob_(programming)) que são [implícitos pelo SDK](../project-sdk/overview.md#default-includes-and-excludes).</span><span class="sxs-lookup"><span data-stu-id="ab3a2-167">Remove the [globs](https://en.wikipedia.org/wiki/Glob_(programming)) that are [implied by the SDK](../project-sdk/overview.md#default-includes-and-excludes).</span></span> <span data-ttu-id="ab3a2-168">Deixar esses globs em seu projeto causará um erro no build, uma vez que os itens de compilação serão duplicados.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-168">Leaving these globs in your project will cause an error on build because compile items will be duplicated.</span></span>

<span data-ttu-id="ab3a2-169">Após essas etapas, seu projeto deverá estar totalmente compatível com o formato csproj do RTM .NET Core.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-169">After these steps your project should be fully compatible with the RTM .NET Core csproj format.</span></span>

<span data-ttu-id="ab3a2-170">Para obter exemplos de antes e depois da migração do formato csproj antigo para o novo, consulte o artigo [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://devblogs.microsoft.com/dotnet/updating-visual-studio-2017-rc-net-core-tooling-improvements/) (Atualizando o Visual Studio 2017 RC – melhorias na ferramenta .NET Core) no blog do .NET.</span><span class="sxs-lookup"><span data-stu-id="ab3a2-170">For examples of before and after the migration from old csproj format to the new one, see the [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://devblogs.microsoft.com/dotnet/updating-visual-studio-2017-rc-net-core-tooling-improvements/) article on the .NET blog.</span></span>

## <a name="see-also"></a><span data-ttu-id="ab3a2-171">Veja também</span><span class="sxs-lookup"><span data-stu-id="ab3a2-171">See also</span></span>

- [<span data-ttu-id="ab3a2-172">Portar, migrar e atualizar projetos do Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ab3a2-172">Port, Migrate, and Upgrade Visual Studio Projects</span></span>](/visualstudio/porting/port-migrate-and-upgrade-visual-studio-projects)
