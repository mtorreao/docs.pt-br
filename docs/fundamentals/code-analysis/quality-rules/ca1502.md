---
title: 'CA1502: evitar complexidade excessiva (análise de código)'
description: 'Saiba mais sobre a regra de análise de código CA1502: Evite complexidade excessiva'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- AvoidExcessiveComplexity
- CA1502
helpviewer_keywords:
- CA1502
- AvoidExcessiveComplexity
author: gewarren
ms.author: gewarren
dev_langs:
- CSharp
- VB
ms.openlocfilehash: 19c05fa59274b87ad9b64336d73d252ed3b5c68a
ms.sourcegitcommit: 2e4adc490c1d2a705a0592b295d606b10b9f51f1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/25/2020
ms.locfileid: "96584676"
---
# <a name="ca1502-avoid-excessive-complexity"></a><span data-ttu-id="f6e5b-103">CA1502: Evitar complexidade excessiva</span><span class="sxs-lookup"><span data-stu-id="f6e5b-103">CA1502: Avoid excessive complexity</span></span>

| | <span data-ttu-id="f6e5b-104">Valor</span><span class="sxs-lookup"><span data-stu-id="f6e5b-104">Value</span></span> |
|-|-|
| <span data-ttu-id="f6e5b-105">**ID da regra**</span><span class="sxs-lookup"><span data-stu-id="f6e5b-105">**Rule ID**</span></span> |<span data-ttu-id="f6e5b-106">CA1502</span><span class="sxs-lookup"><span data-stu-id="f6e5b-106">CA1502</span></span>|
| <span data-ttu-id="f6e5b-107">**Categoria**</span><span class="sxs-lookup"><span data-stu-id="f6e5b-107">**Category**</span></span> |<span data-ttu-id="f6e5b-108">Microsoft. Maintainabilidade</span><span class="sxs-lookup"><span data-stu-id="f6e5b-108">Microsoft.Maintainability</span></span>|
| <span data-ttu-id="f6e5b-109">**A correção está sendo interrompida ou não está sendo interrompida**</span><span class="sxs-lookup"><span data-stu-id="f6e5b-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="f6e5b-110">Sem interrupção</span><span class="sxs-lookup"><span data-stu-id="f6e5b-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="f6e5b-111">Causa</span><span class="sxs-lookup"><span data-stu-id="f6e5b-111">Cause</span></span>

<span data-ttu-id="f6e5b-112">Um método tem uma complexidade ciclomática excessiva.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-112">A method has an excessive cyclomatic complexity.</span></span>

## <a name="rule-description"></a><span data-ttu-id="f6e5b-113">Descrição da regra</span><span class="sxs-lookup"><span data-stu-id="f6e5b-113">Rule description</span></span>

<span data-ttu-id="f6e5b-114">A *complexidade ciclomática* mede o número de caminhos linearmente independentes por meio do método, que é determinado pelo número e pela complexidade de ramificações condicionais.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-114">*Cyclomatic complexity* measures the number of linearly independent paths through the method, which is determined by the number and complexity of conditional branches.</span></span> <span data-ttu-id="f6e5b-115">Uma complexidade ciclomática baixa geralmente indica um método que é fácil de entender, testar e manter.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-115">A low cyclomatic complexity generally indicates a method that is easy to understand, test, and maintain.</span></span> <span data-ttu-id="f6e5b-116">A complexidade do ciclomática é calculada a partir de um grafo de fluxo de controle do método e é fornecida da seguinte maneira:</span><span class="sxs-lookup"><span data-stu-id="f6e5b-116">The cyclomatic complexity is calculated from a control flow graph of the method and is given as follows:</span></span>

<span data-ttu-id="f6e5b-117">complexidade ciclomática = o número de bordas – o número de nós + 1</span><span class="sxs-lookup"><span data-stu-id="f6e5b-117">cyclomatic complexity = the number of edges - the number of nodes + 1</span></span>

<span data-ttu-id="f6e5b-118">Um *nó* representa um ponto de ramificação lógica e uma *borda* representa uma linha entre nós.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-118">A *node* represents a logic branch point and an *edge* represents a line between nodes.</span></span>

<span data-ttu-id="f6e5b-119">A regra relata uma violação quando a complexidade do ciclomática é maior que 25.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-119">The rule reports a violation when the cyclomatic complexity is more than 25.</span></span>

<span data-ttu-id="f6e5b-120">Você pode aprender mais sobre as métricas de código em [medir a complexidade do código gerenciado](/visualstudio/code-quality/code-metrics-values).</span><span class="sxs-lookup"><span data-stu-id="f6e5b-120">You can learn more about code metrics at [Measure complexity of managed code](/visualstudio/code-quality/code-metrics-values).</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="f6e5b-121">Como corrigir violações</span><span class="sxs-lookup"><span data-stu-id="f6e5b-121">How to fix violations</span></span>

<span data-ttu-id="f6e5b-122">Para corrigir uma violação dessa regra, refatore o método para reduzir sua complexidade de ciclomática.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-122">To fix a violation of this rule, refactor the method to reduce its cyclomatic complexity.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="f6e5b-123">Quando suprimir avisos</span><span class="sxs-lookup"><span data-stu-id="f6e5b-123">When to suppress warnings</span></span>

<span data-ttu-id="f6e5b-124">É seguro suprimir um aviso dessa regra se a complexidade não puder ser facilmente reduzida e o método for fácil de entender, testar e manter.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-124">It is safe to suppress a warning from this rule if the complexity cannot easily be reduced and the method is easy to understand, test, and maintain.</span></span> <span data-ttu-id="f6e5b-125">Em particular, um método que contém uma `switch` instrução grande ( `Select` em Visual Basic) é um candidato para exclusão.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-125">In particular, a method that contains a large `switch` (`Select` in Visual Basic) statement is a candidate for exclusion.</span></span> <span data-ttu-id="f6e5b-126">O risco de desestabilizar a base de código no final do ciclo de desenvolvimento ou introduzir uma alteração inesperada no comportamento de tempo de execução no código fornecido anteriormente pode superar os benefícios de manutenção da refatoração do código.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-126">The risk of destabilizing the code base late in the development cycle or introducing an unexpected change in run-time behavior in previously shipped code might outweigh the maintainability benefits of refactoring the code.</span></span>

## <a name="how-cyclomatic-complexity-is-calculated"></a><span data-ttu-id="f6e5b-127">Como a complexidade do ciclomática é calculada</span><span class="sxs-lookup"><span data-stu-id="f6e5b-127">How cyclomatic complexity is calculated</span></span>

<span data-ttu-id="f6e5b-128">A complexidade do ciclomática é calculada adicionando 1 ao seguinte:</span><span class="sxs-lookup"><span data-stu-id="f6e5b-128">The cyclomatic complexity is calculated by adding 1 to the following:</span></span>

- <span data-ttu-id="f6e5b-129">Número de ramificações (como `if` , `while` e `do` )</span><span class="sxs-lookup"><span data-stu-id="f6e5b-129">Number of branches (such as `if`, `while`, and `do`)</span></span>

- <span data-ttu-id="f6e5b-130">Número de `case` instruções em um `switch`</span><span class="sxs-lookup"><span data-stu-id="f6e5b-130">Number of `case` statements in a `switch`</span></span>

## <a name="examples"></a><span data-ttu-id="f6e5b-131">Exemplos</span><span class="sxs-lookup"><span data-stu-id="f6e5b-131">Examples</span></span>

<span data-ttu-id="f6e5b-132">Os exemplos a seguir mostram métodos que têm complexidades ciclomática variáveis.</span><span class="sxs-lookup"><span data-stu-id="f6e5b-132">The following examples show methods that have varying cyclomatic complexities.</span></span>

### <a name="cyclomatic-complexity-of-1"></a><span data-ttu-id="f6e5b-133">Complexidade ciclomática de 1</span><span class="sxs-lookup"><span data-stu-id="f6e5b-133">Cyclomatic complexity of 1</span></span>

```csharp
public void Method()
{
    Console.WriteLine("Hello World!");
}
```

```vb
Public Sub Method()
    Console.WriteLine("Hello World!")
End Sub
```

### <a name="cyclomatic-complexity-of-2"></a><span data-ttu-id="f6e5b-134">Complexidade ciclomática de 2</span><span class="sxs-lookup"><span data-stu-id="f6e5b-134">Cyclomatic complexity of 2</span></span>

```csharp
void Method(bool condition)
{
    if (condition)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition As Boolean)
    If (condition) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-3"></a><span data-ttu-id="f6e5b-135">Complexidade ciclomática de 3</span><span class="sxs-lookup"><span data-stu-id="f6e5b-135">Cyclomatic complexity of 3</span></span>

```csharp
public void Method(bool condition1, bool condition2)
{
    if (condition1 || condition2)
    {
        Console.WriteLine("Hello World!");
    }
}
```

```vb
Public Sub Method(ByVal condition1 As Boolean, ByVal condition2 As Boolean)
    If (condition1 OrElse condition2) Then
        Console.WriteLine("Hello World!")
    End If
End Sub
```

### <a name="cyclomatic-complexity-of-8"></a><span data-ttu-id="f6e5b-136">Ciclomática complexidade de 8</span><span class="sxs-lookup"><span data-stu-id="f6e5b-136">Cyclomatic complexity of 8</span></span>

```csharp
public void Method(DayOfWeek day)
{
    switch (day)
    {
        case DayOfWeek.Monday:
            Console.WriteLine("Today is Monday!");
            break;
        case DayOfWeek.Tuesday:
            Console.WriteLine("Today is Tuesday!");
            break;
        case DayOfWeek.Wednesday:
            Console.WriteLine("Today is Wednesday!");
            break;
        case DayOfWeek.Thursday:
            Console.WriteLine("Today is Thursday!");
            break;
        case DayOfWeek.Friday:
            Console.WriteLine("Today is Friday!");
            break;
        case DayOfWeek.Saturday:
            Console.WriteLine("Today is Saturday!");
            break;
        case DayOfWeek.Sunday:
            Console.WriteLine("Today is Sunday!");
            break;
    }
}
```

```vb
Public Sub Method(ByVal day As DayOfWeek)
    Select Case day
        Case DayOfWeek.Monday
            Console.WriteLine("Today is Monday!")
        Case DayOfWeek.Tuesday
            Console.WriteLine("Today is Tuesday!")
        Case DayOfWeek.Wednesday
            Console.WriteLine("Today is Wednesday!")
        Case DayOfWeek.Thursday
            Console.WriteLine("Today is Thursday!")
        Case DayOfWeek.Friday
            Console.WriteLine("Today is Friday!")
        Case DayOfWeek.Saturday
            Console.WriteLine("Today is Saturday!")
        Case DayOfWeek.Sunday
            Console.WriteLine("Today is Sunday!")
    End Select
End Sub
```

## <a name="related-rules"></a><span data-ttu-id="f6e5b-137">Regras relacionadas</span><span class="sxs-lookup"><span data-stu-id="f6e5b-137">Related rules</span></span>

[<span data-ttu-id="f6e5b-138">CA1501: Evitar herança excessiva</span><span class="sxs-lookup"><span data-stu-id="f6e5b-138">CA1501: Avoid excessive inheritance</span></span>](ca1501.md)

## <a name="see-also"></a><span data-ttu-id="f6e5b-139">Confira também</span><span class="sxs-lookup"><span data-stu-id="f6e5b-139">See also</span></span>

- [<span data-ttu-id="f6e5b-140">Medindo complexidade e facilidade de manutenção do código gerenciado</span><span class="sxs-lookup"><span data-stu-id="f6e5b-140">Measuring Complexity and Maintainability of Managed Code</span></span>](/visualstudio/code-quality/code-metrics-values)
