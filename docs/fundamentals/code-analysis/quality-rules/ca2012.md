---
title: 'CA2012: usar o ValueTasks corretamente (análise de código)'
description: 'Saiba mais sobre a regra de análise de código CA2012: usar o ValueTasks corretamente'
ms.date: 06/18/2020
ms.topic: reference
f1_keywords:
- UseValueTasksCorrectly
- CA2012
helpviewer_keywords:
- UseValueTasksCorrectly
- CA2012
author: stephentoub
ms.author: stoub
ms.openlocfilehash: 0bd2a2b18f61f6024b4231b0188f386e292d9f65
ms.sourcegitcommit: 2e4adc490c1d2a705a0592b295d606b10b9f51f1
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 09/25/2020
ms.locfileid: "96584770"
---
# <a name="ca2012-use-valuetasks-correctly"></a><span data-ttu-id="c02aa-103">CA2012: Usar ValueTasks corretamente</span><span class="sxs-lookup"><span data-stu-id="c02aa-103">CA2012: Use ValueTasks correctly</span></span>

| | <span data-ttu-id="c02aa-104">Valor</span><span class="sxs-lookup"><span data-stu-id="c02aa-104">Value</span></span> |
|-|-|
| <span data-ttu-id="c02aa-105">**ID da regra**</span><span class="sxs-lookup"><span data-stu-id="c02aa-105">**Rule ID**</span></span> |<span data-ttu-id="c02aa-106">CA2012</span><span class="sxs-lookup"><span data-stu-id="c02aa-106">CA2012</span></span>|
| <span data-ttu-id="c02aa-107">**Categoria**</span><span class="sxs-lookup"><span data-stu-id="c02aa-107">**Category**</span></span> |<span data-ttu-id="c02aa-108">Microsoft. confiabilidade</span><span class="sxs-lookup"><span data-stu-id="c02aa-108">Microsoft.Reliability</span></span>|
| <span data-ttu-id="c02aa-109">**A correção está sendo interrompida ou não está sendo interrompida**</span><span class="sxs-lookup"><span data-stu-id="c02aa-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="c02aa-110">Sem interrupção</span><span class="sxs-lookup"><span data-stu-id="c02aa-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="c02aa-111">Causa</span><span class="sxs-lookup"><span data-stu-id="c02aa-111">Cause</span></span>

<span data-ttu-id="c02aa-112">Uma <xref:System.Threading.Tasks.ValueTask> instância retornada de uma invocação de membro é usada de uma forma que possa levar a exceções, danos ou baixo desempenho.</span><span class="sxs-lookup"><span data-stu-id="c02aa-112">A <xref:System.Threading.Tasks.ValueTask> instance returned from a member invocation is used in a way that could lead to exceptions, corruption, or poor performance.</span></span>

## <a name="rule-description"></a><span data-ttu-id="c02aa-113">Descrição da regra</span><span class="sxs-lookup"><span data-stu-id="c02aa-113">Rule description</span></span>

<span data-ttu-id="c02aa-114"><xref:System.Threading.Tasks.ValueTask> as instâncias retornadas de invocações de membro devem ser diretamente aguardadas.</span><span class="sxs-lookup"><span data-stu-id="c02aa-114"><xref:System.Threading.Tasks.ValueTask> instances returned from member invocations are intended to be directly awaited.</span></span>  <span data-ttu-id="c02aa-115">Tenta consumir um ValueTask várias vezes ou para acessar diretamente um resultado antes que seja conhecido a ser concluído pode resultar em uma exceção ou corrupção.</span><span class="sxs-lookup"><span data-stu-id="c02aa-115">Attempts to consume a ValueTask multiple times or to directly access one's result before it's known to be completed may result in an exception or corruption.</span></span>  <span data-ttu-id="c02aa-116">Ignorar essa ValueTask é provavelmente uma indicação de um bug funcional e pode prejudicar o desempenho.</span><span class="sxs-lookup"><span data-stu-id="c02aa-116">Ignoring such a ValueTask is likely an indication of a functional bug and may degrade performance.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="c02aa-117">Como corrigir violações</span><span class="sxs-lookup"><span data-stu-id="c02aa-117">How to fix violations</span></span>

<span data-ttu-id="c02aa-118">Em geral, ValueTasks deve ser diretamente aguardado em vez de descartados ou armazenados em outros locais, como variáveis locais ou campos.</span><span class="sxs-lookup"><span data-stu-id="c02aa-118">In general, ValueTasks should be directly awaited rather than discarded or stored into other locations like local variables or fields.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="c02aa-119">Quando suprimir avisos</span><span class="sxs-lookup"><span data-stu-id="c02aa-119">When to suppress warnings</span></span>

<span data-ttu-id="c02aa-120">Para ValueTasks retornados de chamadas de membro arbitrárias, o chamador precisa pressupor que o ValueTask deve ser consumido (por exemplo, esperado) uma vez e apenas uma vez.</span><span class="sxs-lookup"><span data-stu-id="c02aa-120">For ValueTasks returned from arbitrary member calls, the caller needs to assume that the ValueTask must be consumed (e.g. awaited) once and only once.</span></span>  <span data-ttu-id="c02aa-121">No entanto, se o desenvolvedor também controlar o membro que está sendo invocado e tiver conhecimento completo de sua implementação, o desenvolvedor poderá saber que é seguro suprimir o aviso, por exemplo, se o ValueTask de retorno sempre encapsular um <xref:System.Threading.Tasks.Task> objeto.</span><span class="sxs-lookup"><span data-stu-id="c02aa-121">However, if the developer also controls the member being invoked and has complete knowledge of its implementation, the developer may know it's safe to suppress the warning, for example, if the return ValueTask always wraps a <xref:System.Threading.Tasks.Task> object.</span></span>

## <a name="see-also"></a><span data-ttu-id="c02aa-122">Confira também</span><span class="sxs-lookup"><span data-stu-id="c02aa-122">See also</span></span>

- [<span data-ttu-id="c02aa-123">Regras de confiabilidade</span><span class="sxs-lookup"><span data-stu-id="c02aa-123">Reliability rules</span></span>](reliability-warnings.md)
